<!--
  ~ This file is part of Hopsworks
  ~ Copyright (C) 2018, Logical Clocks AB. All rights reserved
  ~
  ~ Hopsworks is free software: you can redistribute it and/or modify it under the terms of
  ~ the GNU Affero General Public License as published by the Free Software Foundation,
  ~ either version 3 of the License, or (at your option) any later version.
  ~
  ~ Hopsworks is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
  ~ without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
  ~ PURPOSE.  See the GNU Affero General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Affero General Public License along with this program.
  ~ If not, see <https://www.gnu.org/licenses/>.
  -->

<div ng-controller="MainCtrl as mainCtrl">
    <div ng-include="'nav.html'"></div>
    <div id="wrapper" class="toggled" ng-controller="featurestoreCtrl as featurestoreCtrl">
        <div class="overlay"></div>
        <div ng-include="'navProject.html'"></div>
        <div class="container-fluid" id="main">
            <div ng-if="featurestoreCtrl.loading" class="loadingwrap" style="z-index: 102">
                <div class="loading-content">
                    <div class="loader-in-wrap"></div>
                    {{featurestoreCtrl.loadingText}}
                </div>
            </div>
            <div class="row row-offcanvas row-offcanvas-left">
                <!--/col-->

                <div class="col-md-9 col-lg-10 main">

                    <h1 class="display-4 hidden-xs-down fs_title">
                        <!-- Feature Store: {{featurestoreCtrl.featurestore.featurestoreName}}-->
                    </h1>

                    <div class="row mb-3" id="#headRow">
                        <div class="col-sm-2">
                            <div class="fs_card card card-inverse card-success">
                                <div class="fs_card card-block bg-success">
                                    <h5 class="fs_card text-uppercase bold_fs fs_top_card fs_top_heading">Features</h5>
                                    <h1 class="fs_card display-1 fs_top_card fs_top_num">
                                        {{featurestoreCtrl.features.length}}</h1>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-2">
                            <div class="fs_card card card-inverse card-info">
                                <div class="fs_card card-block bg-info">
                                    <h5 class="fs_card text-uppercase bold_fs fs_top_card fs_top_heading">Feature
                                        Groups</h5>
                                    <h1 class="fs_card display-1 fs_top_card fs_top_num">
                                        {{featurestoreCtrl.featuregroups.length}}</h1>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-2">
                            <div class="fs_card card card-inverse card-warning">
                                <div class="fs_card card-block bg-warning">
                                    <h5 class="fs_card text-uppercase bold_fs fs_top_card fs_top_heading">Training
                                        Datasets</h5>
                                    <h1 class="fs_card display-1 fs_top_card fs_top_num">
                                        {{featurestoreCtrl.trainingDatasets.length}}</h1>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4" style="margin-top:-25px; max-height:150px;">
                            <div id="featureProgressChart">
                            </div>
                        </div>
                        <div class="col-sm-2" style="margin-top:-32px; max-width:150px; max-height:150px">
                            <div id="quotaChart" style="max-height:150px;" ng-if="featurestoreCtrl.featurestoreHdfsQuota() != null">
                            </div>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-sm-2">
                            <small class="text-muted">
                                Last updated
                                <time am-time-ago="featurestoreCtrl.date"></time>
                            </small>
                        </div>
                        <div class="col-sm-2">
                        </div>
                        <div class="col-sm-2">
                        </div>
                        <div class="col-sm-4">
                            <small class="text-muted" style="margin-left:50px">
                                Number of features over time.
                            </small>
                        </div>
                        <div class="col-sm-2">
                            <small class="text-muted" ng-if="featurestoreCtrl.featurestoreHdfsQuota() != null">
                                {{featurestoreCtrl.featurestoreHdfsUsage()}} of {{featurestoreCtrl.featurestoreHdfsQuota()}} used
                            </small>
                        </div>
                    </div>
                    <!--/row-->

                    <hr>
                    <h2 class="sub-header margin-left fs_sec_title">Feature Groups and Training Datasets</h2>
                    <div class="row mb-3">
                        <div class="col-lg-3 col-md-4">
                        </div>
                        <div class="col-lg-9 col-md-8">
                            <div class="row"
                                 ng-show="featurestoreCtrl.featurestoreEntitiesDictList.length > 0"
                                 style="margin-right: 20px">
                                <div class="row form-inline" style="margin-top: 10px;">
                                    <div class="col-sm-6 col-md-6 col-lg-6 form-group">
                                        <label style="margin-left: 20px">
                                            Search:
                                            <input class="form-control"
                                                   style="margin-left: 10px;"
                                                   ng-model="featurestoreCtrl.fseFilter">
                                        </label>
                                    </div>
                                    <div class="col-sm-6 col-md-6 col-lg-6">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-lg-3 col-md-4">
                            <div class="fs_card card">
                                <img class="fs_card card-img-top img-responsive" src="images/create_fg_banner.png"
                                     alt="Card image cap"
                                     ng-click="featurestoreCtrl.showCreateFeaturegroupForm()"
                                >
                                <div class="fs_card card-block">
                                    <h4 class="fs_card card-title fs_card_title">Define new features</h4>
                                    <p class="fs_card card-text">Specify the feature definitons, including the type,
                                        and documentation. After defining the features, you can insert into the
                                        feature store using the Scala/Java or Python API.</p>
                                    <a class="fs_card btn btn-primary fs-banner-create"
                                       ng-click="featurestoreCtrl.showCreateFeaturegroupForm()"
                                       uib-tooltip="Create new feature group"
                                       id="createNewFg"
                                    >
                                        Create Feature Group
                                    </a>
                                </div>
                            </div>

                            <div class="fs_card card card-inverse bg-inverse mt-3">
                                <div class="fs_card card-block">
                                    <h3 class="fs_card card-title fs_card_title">Define an immutable dataset for machine
                                        learning
                                        experiments.</h3>
                                    <p class="fs_card card-text">Datasets can be created for TensorFlow, PyTorch,
                                        SkLearn, and
                                        Keras. After defining the training dataset, you can insert into the
                                        feature store using the Scala/Java or Python API.</p>
                                    <a class="fs_card btn btn-outline-secondary fs-banner-create"
                                       ng-click="featurestoreCtrl.showCreateTrainingDatasetForm()"
                                       uib-tooltip="Create new training dataset"
                                       id="createNewTd"
                                    >
                                        Create Training Dataset
                                    </a>
                                </div>
                            </div>

                        </div>
                        <div class="col-lg-9 col-md-8">
                            <h3 class="text-muted" style="text-align: center;"
                                ng-show="featurestoreCtrl.featurestoreEntitiesDictList.length < 1">
                                No Feature Groups or Training Datasets to show
                            </h3>
                            <div class="row"
                                 ng-show="featurestoreCtrl.featurestoreEntitiesDictList.length > 0"
                                 style="margin-right: 20px">
                                <div class="table-responsive fs-table" id="fgAndTdTable">
                                    <table class="table table-striped table-hover fs-table">
                                        <thead class="thead-inverse fs-table">
                                        <tr>
                                            <th style="width: 40%" ng-click="featurestoreCtrl.sort('name')" class="fs-table">
                                                Name
                                                <i class="fa fa-info-circle" tooltip-placement="auto left"
                                                   uib-tooltip="The name of the feature group or training dataset"
                                                   style="margin-left: 5px"></i>
                                                <span class="glyphicon sort-icon"
                                                      ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                                            </th>
                                            <th style="width: 40%" ng-click="featurestoreCtrl.sort('type')" class="fs-table">
                                                Type
                                                <i class="fa fa-info-circle" tooltip-placement="auto left"
                                                   uib-tooltip="The type, whether a training dataset or feature group"
                                                   style="margin-left: 5px"></i>
                                                <span class="glyphicon sort-icon"
                                                      ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span>
                                            </th>
                                            <th style="width: 10%" class="fs-table">
                                                Version
                                                <i class="fa fa-info-circle" tooltip-placement="auto left"
                                                   uib-tooltip="The version of the feature group"
                                                   style="margin-left: 5px"></i>
                                            </th>
                                            <th style="width: 10%" id="fgActionCol" class="fs-table">
                                                Actions
                                                <i class="fa fa-info-circle" tooltip-placement="auto left"
                                                   uib-tooltip="Delete/Update/Increment Version/Reload contents/View schema/View Details/View Statistics"
                                                   style="margin-left: 5px"></i>
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody class="table-hover fs-table">
                                        <tr
                                                dir-paginate="entity in featurestoreCtrl.featurestoreEntitiesDictList| orderBy :featurestoreCtrl.featurestoreEntitySortKey:featurestoreCtrl.reverse| filter:featurestoreCtrl.fseFilter:false | itemsPerPage:featurestoreCtrl.pageSize"
                                                pagination-id="featurestoreentitiestable"
                                                class="fs-table">
                                            <td class="fs-table">{{entity.name}}</td>
                                            <td class="fs-table">{{entity.type}}</td>
                                            <td class="fs-table">
                                                <ui-select ng-model="entity.activeVersion"
                                                           style="z-index: {{100-$index}}">
                                                    <ui-select-match
                                                            placeholder="Select a version">
                                                        <span>{{$select.selected}}</span>
                                                    </ui-select-match>
                                                    <ui-select-choices repeat="version in entity.versions">
                                                        <span ng-bind="version"></span>
                                                    </ui-select-choices>
                                                </ui-select>
                                            </td>
                                            <td class="fs-table">
                                                <div class="btn-group fs-btn" role="group"
                                                     ng-if="entity.type=='Feature Group'">
                                                    <button class="btn btn-success glyphicon glyphicon glyphicon-stats"
                                                            uib-tooltip="View statistics"
                                                            ng-click="featurestoreCtrl.viewFeaturegroupStatistics(entity.versionToGroups[entity.activeVersion]); $event.stopPropagation();"></button>
                                                    <button class="btn btn-danger glyphicon glyphicon-trash"
                                                            uib-tooltip="Delete"
                                                            ng-click="featurestoreCtrl.deleteFeaturegroup(entity.versionToGroups[entity.activeVersion]); $event.stopPropagation();"></button>
                                                    <div uib-dropdown class="btn-group" role="group"
                                                         style="z-index: auto;">
                                                        <button type="button"
                                                                uib-dropdown-toggle class="btn btn-default glyphicon"
                                                                style="font-family: sans-serif;"
                                                        >
                                                            More
                                                            <span class="caret"></span>
                                                        </button>
                                                        <ul uib-dropdown-menu class="dropdown-menu dropdown-menu-right"
                                                            style="font-family: sans-serif;">
                                                            <li><a role="menuitem"
                                                                   ng-click="featurestoreCtrl.newFeaturegroupVersion(entity.versionToGroups, entity.versions); $event.stopPropagation();">
                                                                Create new feature group version</a></li>
                                                            <li><a role="menuitem"
                                                                   ng-click="featurestoreCtrl.clearFeaturegroupContents(entity.versionToGroups[entity.activeVersion]); $event.stopPropagation();">
                                                                Clear feature group contents</a></li>
                                                            <li><a role="menuitem"
                                                                   ng-click="featurestoreCtrl.updateFeaturegroup(entity.versionToGroups[entity.activeVersion]); $event.stopPropagatphicion();">
                                                                Edit feature group</a></li>
                                                            <li><a role="menuitem"
                                                                   ng-click="featurestoreCtrl.previewFeaturegroup(entity.versionToGroups[entity.activeVersion]);">
                                                                Preview feature group data</a></li>
                                                            <li><a role="menuitem"
                                                                   ng-click="featurestoreCtrl.viewFeaturegroupInfo(entity.versionToGroups[entity.activeVersion]);">
                                                                View feature group details</a></li>
                                                            <li><a role="menuitem"
                                                                   ng-click="featurestoreCtrl.viewSchemaContent(entity.versionToGroups[entity.activeVersion]);">
                                                                View feature group schema</a></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="btn-group fs-btn" role="group"
                                                     ng-if="entity.type=='Training Dataset'">
                                                    <button
                                                            class="fs-btn btn btn-success glyphicon glyphicon glyphicon-stats"
                                                            uib-tooltip="View statistics"
                                                            ng-click="featurestoreCtrl.viewTrainingDatasetStatistics(entity.versionToGroups[entity.activeVersion]); $event.stopPropagation();"></button>
                                                    <button class="fs-btn btn btn-danger glyphicon glyphicon-trash"
                                                            uib-tooltip="Delete"
                                                            ng-click="featurestoreCtrl.deleteTrainingDataset(entity.versionToGroups[entity.activeVersion]); $event.stopPropagation();"></button>
                                                    <div uib-dropdown class="btn-group" role="group"
                                                         style="z-index: auto;">
                                                        <button type="button"
                                                                uib-dropdown-toggle
                                                                class="fs-btn btn btn-default glyphicon"
                                                                style="font-family: sans-serif;"
                                                        >
                                                            More
                                                            <span class="caret"></span>
                                                        </button>
                                                        <ul uib-dropdown-menu class="dropdown-menu dropdown-menu-right"
                                                            style="font-family: sans-serif;">
                                                            <li><a role="menuitem"
                                                                   ng-click="featurestoreCtrl.newTrainingDatasetVersion(entity.versionToGroups, entity.versions); $event.stopPropagation();">
                                                                Create new training dataset version</a></li>
                                                            <li><a role="menuitem"
                                                                   ng-click="featurestoreCtrl.updateTrainingDataset(entity.versionToGroups[entity.activeVersion]); $event.stopPropagatphicion();">
                                                                Edit training dataset</a></li>
                                                            <li><a role="menuitem"
                                                                   ng-click="featurestoreCtrl.viewTrainingDatasetInfo(entity.versionToGroups[entity.activeVersion]);">
                                                                View training dataset details</a></li>
                                                            <li><a role="menuitem"
                                                                   ng-click="featurestoreCtrl.viewTrainingDatasetSchemaContent(entity.versionToGroups[entity.activeVersion])">
                                                                View training dataset schema</a></li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                    <dir-pagination-controls
                                            pagination-id="featurestoreentitiestable"
                                            class="pull-right fs-table"
                                            max-size="5"
                                            direction-links="true"
                                            boundary-links="true"
                                            style="margin-right: 20px; margin-top: -35px;"
                                    >
                                    </dir-pagination-controls>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--/row-->

                    <a id="more"></a>
                    <hr>
                    <h2 class="sub-header margin-left fs_sec_title">Feature Search</h2>
                    <div class="fs_card card-deck-wrapper mb-3 feature-search margin-left">
                        <div class="row">
                            <div class="col-sm-3" style="margin-top:35px">
                                <form class="form-inline mr-auto">
                                    <input class="form-control mr-sm-2 f-search-input" type="text"
                                           placeholder="Search"
                                           aria-label="Search"
                                           ng-model="featurestoreCtrl.featureSearchQuery"
                                    >
                                    <button class="btn btn-unique btn-rounded btn-sm my-0"
                                            ng-click="featurestoreCtrl.featureSearch(featurestoreCtrl.featureSearchQuery); $event.stopPropagation();">
                                        Search
                                    </button>
                                </form>
                            </div>
                            <div class="col-sm-5">
                                <div ng-if="!featurestoreCtrl.hasFeatureSearchResult()">
                                    <h5 class="text-uppercase bold_fs" style="margin-top:100px; text-align:center">
                                        No Search Results
                                    </h5>
                                </div>
                                <div ng-if="featurestoreCtrl.hasFeatureSearchResult()">
                                    <div class="row">
                                        <div>
                                            <button class="close" ng-click="featurestoreCtrl.resetFeatureSearchResult()"
                                                    type="button">
                                                <span aria-hidden="true">&times;</span></button>
                                        </div>
                                    </div>
                                    <div class="row" ng-if="featurestoreCtrl.featureSearchResultIsNotFound()">
                                        <h4 style="text-align: center;">{{featurestoreCtrl.featureSearchResult}}</h4>
                                    </div>
                                    <div ng-if="!featurestoreCtrl.featureSearchResultIsNotFound()" class="row">
                                        <div class="multipleSearchResults row"
                                             ng-if="featurestoreCtrl.hasMultipleSearchResults()"
                                             style="margin-top:10px;margin-left:10px;margin-right:5px">
                                            <div class="col-sm-4"> The feature
                                                `{{featurestoreCtrl.featureSearchResult.name}}` was found in
                                                multiple feature groups.
                                            </div>
                                            <div class="col-sm-7">
                                                <ui-select ng-model="featurestoreCtrl.selectedSearchFeaturegroup"
                                                           on-select="featurestoreCtrl.onSelectFeaturegroupSearchResultCallback($item.name)"
                                                           style="z-index: 101"
                                                           id="selectFeatureGroupSearchResult"
                                                >
                                                    <ui-select-match placeholder="Select a feature group">
                                                        <span>{{$select.selected.longName}}</span>
                                                    </ui-select-match>
                                                    <ui-select-choices
                                                            repeat="item in featurestoreCtrl.featureSearchResultFeaturegroups">
                                                        <span ng-bind="item.longName"></span>
                                                    </ui-select-choices>
                                                </ui-select>
                                            </div>
                                            <div class="col-sm-1">
                                            </div>
                                        </div>
                                        <div id="accordion" role="tablist" aria-multiselectable="true"
                                             style="margin-top:20px" class="col-sm-11">
                                            <div class="fs_card card">

                                                <h5 class="text-uppercase bold_fs" style="margin-top: 20px;
                                                margin-bottom: 20px; margin-left: 15px">
                                                    Feature: <span class="text-lowercase">{{featurestoreCtrl.featureSearchResult.name}}</span>
                                                </h5>

                                                <div class="fs_card card-header" role="tab" id="infoHeading"
                                                     data-toggle="collapse" data-parent="#accordion" href="#info"
                                                     aria-expanded="false" aria-controls="info">
                                                    <h5 class="text-uppercase bold_fs">
                                                        Info
                                                    </h5>
                                                </div>
                                                <div id="info" class="fs_card card-block collapse" role="tabpanel"
                                                     aria-labelledby="infoHeading">
                                                    <p><span style="font-weight:bold">Feature: </span>
                                                        {{featurestoreCtrl.featureSearchResult.name}}
                                                    </p>
                                                    <p><span style="font-weight:bold">Version: </span>
                                                        {{featurestoreCtrl.featureSearchResult.version}} </p>
                                                    <p><span style="font-weight:bold">Type: </span>
                                                        {{featurestoreCtrl.featureSearchResult.type}} </p>
                                                    <p><span style="font-weight:bold">Description: </span>
                                                        {{featurestoreCtrl.featureSearchResult.description}} </p>
                                                    <p><span style="font-weight:bold">Primary: </span>
                                                        {{featurestoreCtrl.featureSearchResult.primary}} </p>
                                                    <p><span style="font-weight:bold">Feature Group: </span>
                                                        {{featurestoreCtrl.featureSearchResult.featuregroup}} </p>
                                                </div>
                                                <div class="fs_card card-header" role="tab" id="apiHeading"
                                                     data-toggle="collapse" data-parent="#accordion" href="#api"
                                                     aria-expanded="false" aria-controls="api">
                                                    <h5 class="text-uppercase bold_fs">
                                                        API
                                                    </h5>
                                                </div>
                                                <div id="api" class="fs_card card-block collapse" role="tabpanel"
                                                     aria-labelledby="apiHeading">
                                                    <pre>
                                                    <code>
{{featurestoreCtrl.getCode(featurestoreCtrl.featureSearchResult)}}
                                                    </code>
                                                    </pre>
                                                </div>
                                                <div class="fs_card card-header" role="tab" id="featuregroupHeading"
                                                     data-toggle="collapse" data-parent="#accordion"
                                                     href="#featuregroup"
                                                     aria-expanded="false" aria-controls="featuregroup">
                                                    <h5 class="text-uppercase bold_fs">
                                                        Feature Group
                                                    </h5>
                                                </div>
                                                <div id="featuregroup" class="fs_card  card-block collapse"
                                                     role="tabpanel"
                                                     aria-labelledby="featuregroupHeading">
                                                    <ul class="list-unstyled">
                                                        <li>
                                                            <span style="font-weight:700">Id:</span>
                                                            {{featurestoreCtrl.selectedSearchFeaturegroup.featuregroup.id}}
                                                        </li>
                                                        <li>
                                                            <span style="font-weight:700">Name:</span>
                                                            {{featurestoreCtrl.selectedSearchFeaturegroup.featuregroup.name}}
                                                        </li>
                                                        <li>
                                                            <span style="font-weight:700">Version:</span>
                                                            {{featurestoreCtrl.selectedSearchFeaturegroup.featuregroup.version}}
                                                        </li>
                                                        <li>
                                                            <span style="font-weight:700">Description:</span>
                                                            {{featurestoreCtrl.selectedSearchFeaturegroup.featuregroup.description}}
                                                        </li>
                                                        <li>
                                                            <span style="font-weight:700">HDFS Path:</span>
                                                            {{featurestoreCtrl.selectedSearchFeaturegroup.featuregroup.hdfsStorePaths[0]}}
                                                        </li>
                                                        <li>
                                                            <span style="font-weight:700">Creator:</span>
                                                            {{featurestoreCtrl.selectedSearchFeaturegroup.featuregroup.creator}}
                                                        </li>
                                                        <li>
                                                            <span style="font-weight:700">Created:</span>
                                                            {{formatDate(featurestoreCtrl.selectedSearchFeaturegroup.featuregroup.created)}}
                                                        </li>
                                                        <li>
                                                            <span style="font-weight:700">Size:</span>
                                                            <i ng-if="featurestoreCtrl.featuregroupSizeWorking"
                                                               style="margin-top: 2px"
                                                               class="fa fa-spinner fa-spin pull-right"></i>
                                                            {{featurestoreCtrl.featuregroupSize}}
                                                        </li>
                                                        <li>
                                                            <span style="font-weight:700">Job:</span>
                                                            <span
                                                                    ng-if="featurestoreCtrl.selectedSearchFeaturegroup.featuregroup.jobName === null">
                                                                No job specified
                                                            </span>
                                                            <div
                                                                    ng-if="featurestoreCtrl.selectedSearchFeaturegroup.featuregroup.jobName !== null"
                                                                    , style="display:inline;">
                                                                <span ng-if="featurestoreCtrl.isJobLocal(featurestoreCtrl.selectedSearchFeaturegroup.featuregroup.jobId)"
                                                                      style="cursor:pointer;color:black;text-decoration:underline;"
                                                                      ng-click="featurestoreCtrl.launchJob(featurestoreCtrl.selectedSearchFeaturegroup.featuregroup.jobName); $event.stopPropagation();">
                                                                    {{featurestoreCtrl.selectedSearchFeaturegroup.featuregroup.jobName}}
                                                                </span>
                                                                <span
                                                                        ng-if="!featurestoreCtrl.isJobLocal(featurestoreCtrl.selectedSearchFeaturegroup.featuregroup.jobId)"
                                                                        style="color: #880000 ">
                                                                    (The job is owned by another project)
                                                                </span>
                                                            </div>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-1">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <table class="table table-striped table-hover fs-table">
                                    <thead class="thead-inverse fs-table">
                                    <tr class="fs-table">
                                        <th style="width: 5%" class="fs-table">
                                            #
                                        </th>
                                        <th style="width: 80%" ng-click="featurestoreCtrl.sortFeature('name')" class="fs-table">
                                            Feature
                                            <span class="glyphicon sort-icon"
                                                  ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!featuresReverse}"></span>
                                        </th>
                                        <th style="width: 15%" class="fs-table">
                                            Version
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody class="table-hover fs-table">
                                    <tr
                                            dir-paginate="feature in featurestoreCtrl.features| orderBy :featurestoreCtrl.featuresSortKey:featurestoreCtrl.featuresReverse | itemsPerPage:featurestoreCtrl.featuresPageSize"
                                            pagination-id="featurestable"
                                            current-page="featurestoreCtrl.currentPage"
                                            class="fs-table"
                                    >
                                        <td class="fs-table">
                                            {{featurestoreCtrl.getTotalIndex($index)}}
                                        </td>
                                        <td class="fs-table">
                                            <span style="cursor:pointer;color:black;text-decoration:underline;"
                                                  ng-click="featurestoreCtrl.featureSearch(feature.name)">
                                                {{feature.name}}
                                            </span>
                                        </td>
                                        <td class="fs-table">
                                            {{feature.version}}
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                                <dir-pagination-controls
                                        pagination-id="featurestable"
                                        class="pull-right"
                                        max-size="5"
                                        direction-links="true"
                                        boundary-links="true"
                                        style="margin-right: 20px; margin-top: -35px;"
                                >
                                </dir-pagination-controls>
                            </div>
                        </div>
                    </div>
                    <!--/row-->

                    <a id="flexbox"></a>
                    <hr>
                    <h2 class="margin-left fs_sec_title">Feature Store Info</h2>
                    <div class="row">

                        <div class="col-sm-4">
                            <div class="fs_card card">
                                <img class="fs_card card-img-top img-responsive"
                                     src="images/cross_project_features_banner.png" alt="Card image cap">
                                <div class="fs_card card-block">
                                    <h4 class="fs_card card-title fs_card_title">Cross-Project Features</h4>
                                    <div class="row">
                                        <p class="fs_card card-text" style="margin-left:15px; margin-right:15px">
                                            Feature Stores can be shared across projects.
                                            Select a feature store below.
                                        </p>
                                        <p class="fs_card card-text" style="margin-left:15px; margin-right:15px">
                                            <small class="text-muted">Number of available feature stores:
                                                {{featurestoreCtrl.featurestores.length}}
                                            </small>
                                        </p>
                                    </div>
                                    <div class="row" style="margin-top: 20px; margin-bottom:50px; margin-right:15px;
                                    margin-left:5px;">
                                        <ui-select ng-model="featurestoreCtrl.featurestore"
                                                   on-select="featurestoreCtrl.onSelectFeaturestoreCallback($item)"
                                                   style="z-index: 101"
                                                   id="selectFeaturestore"
                                        >
                                            <ui-select-match placeholder="Select a feature store">
                                                <span>{{$select.selected.featurestoreName}}</span>
                                            </ui-select-match>
                                            <ui-select-choices
                                                    repeat="item in featurestoreCtrl.featurestores">
                                                <span ng-bind="item.featurestoreName"></span>
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="fs_card card card-block">
                                <h4 class="fs_card card-title fs_card_title">Recent Feature Engineering Jobs</h4>
                                <p class="fs_card card-text" ng-if="featurestoreCtrl.fe_jobs.length == 0">
                                    No job to show.
                                </p>
                                <table class="table table-hover fs-table" id="fejobsTable"
                                       ng-if="featurestoreCtrl.fe_jobs.length > 0"
                                >
                                    <thead class="fs-table">
                                    <th style="width: 50%" class="fs-table">
                                        Job
                                    </th>
                                    <th style="width: 50%" class="fs-table">
                                        Progress
                                    </th>
                                    </thead>
                                    <tbody class="table-hover fs-table">
                                    <tr data-ng-repeat="job in featurestoreCtrl.fe_jobs track by $index" class="fs-table">
                                        <td class="fs-table">
                                            <span ng-if="featurestoreCtrl.isJobLocal(job.id)"
                                                  style="cursor:pointer;color:black;text-decoration:underline;"
                                                  ng-click="featurestoreCtrl.launchJob(job.name); $event.stopPropagation();">
                                                                    {{job.name}}
                                            </span>
                                            <span ng-if="!featurestoreCtrl.isJobLocal(job.id)" style="color: #880000 ">
                                                (The job is owned by another project)
                                            </span>
                                        </td>
                                        <td class="fs-table">
                                            <div class="progress-bar progress-bar-success progress-bar-striped"
                                                 role="progressbar" aria-valuenow="{{job.progress * 100}}"
                                                 aria-valuemin="0" aria-valuemax="100"
                                                 style="width:{{job.progress * 90}}%"
                                                 ng-if="job.progress !== undefined && job.progress !== null">
                                                {{job.progress * 100}}%
                                            </div>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>

                                <p class="fs_card card-text">
                                    <small class="text-muted">
                                        Last updated
                                        <time am-time-ago="featurestoreCtrl.date"></time>
                                    </small>
                                </p>
                            </div>
                        </div>

                        <div class="col-sm-4">

                            <div class="fs_card card card-block text-center docs_link">
                                <h4 class="fs_card card-title fs_card_title">Documentation</h4>
                                <p>
                                    <a class="third after fs-doc-link"
                                       href="https://hopsworks.readthedocs.io/en/0.9/user_guide/hopsworks/featurestore.html">
                                        General Documentation
                                    </a>
                                </p>
                                <p>
                                    <a class="third after fs-doc-link" href="https://www.logicalclocks.com/feature-store/">
                                        Blog Post
                                    </a>
                                </p>
                                <p>
                                    <a class="third after fs-doc-link" href="http://hops-py.logicalclocks.com/">
                                        Python API
                                    </a>
                                </p>
                                <p>
                                    <a class="third after fs-doc-link" href="http://snurran.sics.se/hops/hops-util-javadoc/0.10.0/">
                                        Java/Scala API
                                    </a>
                                </p>
                                <p>
                                    <a class="third after fs-doc-link" href="https://github.com/logicalclocks/hops-examples">
                                        Examples
                                    </a>
                                </p>
                            </div>
                            <div class="fs_card card">
                                <div class="fs_card card-block">
                                    <h4 class="fs_card card-title fs_card_title">Details</h4>
                                    <ul class="list-unstyled">
                                        <li>
                                            <span style="font-weight:700">Id:</span>
                                            {{featurestoreCtrl.featurestore.featurestoreId}}
                                        </li>
                                        <li>
                                            <span style="font-weight:700">Name:</span>
                                            {{featurestoreCtrl.featurestore.featurestoreName}}
                                        </li>
                                        <li>
                                            <span style="font-weight:700">HDFS Path:</span>
                                            {{featurestoreCtrl.featurestore.hdfsStorePath}}
                                        </li>
                                        <li>
                                            <span style="font-weight:700">Size:</span>
                                            <i ng-if="featurestoreCtrl.featurestoreSizeWorking" style="margin-top: 2px"
                                               class="fa fa-spinner fa-spin pull-right"></i>
                                            {{featurestoreCtrl.featurestoreSize}}
                                        </li>
                                        <li>
                                            <span style="font-weight:700">Created:</span>
                                            {{formatDate(featurestoreCtrl.featurestore.created)}}
                                        </li>
                                        <li>
                                            <span style="font-weight:700">Description:</span>
                                            {{featurestoreCtrl.featurestore.featurestoreDescription}}
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    </body>
                </div>
            </div>
        </div>
    </div>
</div>
